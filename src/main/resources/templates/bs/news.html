<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>公告管理</title>
    <link rel="stylesheet" href="../../static/dist/css/bootstrap.css" type="text/css"/>
    <link rel="stylesheet" href="../../static/switch/bootstrap-switch.min.css" type="text/css"/>
    <script src="../../static/switch/bootstrap-switch.min.js"></script>
    <style>


        .nav-page {
            float: right;

        }

        .page-link {

        }

        .pagination-sm {
            margin-left: 10px;
            margin-right: 10px;

        }

        .tab-f {
            width: 100%;
            height: 31px;

        }

        .ct {
            float: left;
        }

        .btn-f1 {
            text-align: center;
            border-radius: 0.25rem;
            vert-align: middle;
            line-height: 15px !important;
            height: 31px;
        }

        .ta-log {
            width: 93%;

            text-align: center;
        }

        .ta-log-left {

            width: 93%;
            height: 60px;
        }

        /*.fax {*/
        /*    border-radius: 0.25rem !important;*/

        /*}*/

        /*td固定长度，多余部分省略号代替*/
        table {
            table-layout: fixed;
        }

        .td1 {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /*td th元素垂直居中*/
        .table th, .table td {
            text-align: center;
            vertical-align: middle !important;
            /*th td内容的边距*/
            /*margin: 1% 1% 1% 1%;*/
            padding-left: 1%;
            padding-right: 1%;
            /*padding: 8px 1% 8px 1%;*/
        }

        /*列宽设置*/
        .th1 {
            width: 3%;
        }

        .th2 {
            width: 7%;
        }

        .th3 {
            width: 20%;
        }

        .th4 {
            width: 20%;
        }

        .th5 {
            width: 12%;
        }

        .th6 {
            width: 12%;
        }

        .th7 {
            width: 5%;
        }

        .th8 {
            width: 12%;
        }

        /*选中所有元素设置字体*/
        * {
            font-family: Segoe UI;
        }

        /*分页居中*/
        body {
            /*text-align: center;*/
        }

        /*界面微调*/
        .card {
            margin: 0px 20px 0px 0px;
            padding: 0px 0px 0px 0px;
        }

        .card-header {
            margin: 0px;
            padding: 0px 0px 0px 10px;
        }

        .card-body {
            margin: 0px;
            padding: 20px 20px 0px 20px;
        }

        .card-footer {
            margin: 0px;
            padding: 20px 0px 0px 0px;
        }

        .logsUl li {
            float: left;
            list-style: none;
            line-height: 5px;
            font-size: 8px;
            margin-right: 4px;
        }

        .breadcrumb-holder {
            margin: 0px;
            padding: 0px;
        }

        /*两个div同一行（搜索div和分页div同一行*/
        .card-header-left {
            margin: 0px;
            padding: 0px;
            float: left;
        }

        .card-header-right {
            margin: 0px 0px 0px 0px;
            padding: 22px 0px 0px 0px;
            float: left;
        }

        /*表头排序按钮的样式设计*/
        .btn-sort {
            background-color: #212529;
            color: white;
        }

        .btn-sort:hover {
            color: lightgray;
        }

        .btn-sort:active {
            color: #212529;
        }
    </style>
</head>

<body>
<!--<h1 class="text-capitalize text-black-50 font-weight-normal">公告管理</h1>-->
<!--<div class="breadcrumb-holder">-->
<!--    <div class="container-fluid">-->
<!--        <ul class="breadcrumb">-->
<!--            <li class="breadcrumb-item"><a href="index.html">系统管理</a></li>-->
<!--            <li class="breadcrumb-item active">公告管理</li>-->
<!--        </ul>-->
<!--    </div>-->
<!--</div>-->
<div class="breadcrumb-holder">
    <div class="container-fluid">
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">系统管理</a></li>
            <li class="breadcrumb-item active">公告管理</li>
        </ul>
    </div>
</div>
<div class="card">
    <div class="card-header">
        <div class="card-header-left">
            <nav class="navbar navbar-light navbar-left" style="background-color: white">
                <form class="form-inline">
                    <span class="navbar-text">&nbsp;&nbsp;</span>
                    <input class="form-control mr-sm-2" type="search" placeholder="搜索公告标题" aria-label="Search"
                           id="n_title">
                    <button class="btn btn-sm btn-outline-success my-2 my-sm-0 btn-search" type="button"><span
                            class="glyphicon glyphicon-search"></span> 搜索
                    </button>
                    <span class="navbar-text">&nbsp;&nbsp;</span>
                    <button class="btn btn-sm btn-outline-danger my-2 my-sm-0 btn-deleteByBatch" type="button">
                        批量删除
                    </button>
                    <span class="navbar-text">&nbsp;&nbsp;</span>
                    <button class="btn btn-sm btn-outline-success my-2 my-sm-0 btn-openInsert" data-toggle="modal"
                            data-target="" type="button">添加公告
                    </button>
                    <!-- 测试 -->
                    <!--                <button type="button" class="btn btn-danger btn-alert">测试</button>-->
                </form>
            </nav>
        </div>
        <div class="card-header-right">
            <nav aria-label="Page navigation example">
                <ul class="pagination pagination-sm justify-content-center">
                    <li class="page-item">
                        <a class="page-link" id="first" href="#" th:data-url="@{/bs/news}">首页</a>
                    </li>
                    <li class="page-item" id="up"
                        th:data-url="@{/bs/news(pageNum=${pageInfo.hasPreviousPage}?${pageInfo.prePage}:1)}">
                        <a class="page-link" href="#">上一页</a>
                    </li>
                    <li class="page-item active">
                        <a class="page-link" href="#" th:text="${pageInfo.pageNum}">1</a>
                    </li>
                    <!--                <li class="page-item">-->
                    <!--                    <a class="page-link" href="#" th:text="${pageInfo.pageNum+1}">2</a>-->
                    <!--                </li>-->
                    <!--                <li class="page-item">-->
                    <!--                    <a class="page-link" href="#" th:text="${pageInfo.pageNum+2}">3</a>-->
                    <!--                </li>-->
                    <li class="page-item" id="next"
                        th:data-url="@{/bs/news(pageNum=${pageInfo.hasNextPage}?${pageInfo.nextPage}:${pageInfo.pages})}">
                        <a class="page-link" href="#">下一页</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" id="last" href="#"
                           th:data-url="@{/bs/news(pageNum=${pageInfo.pages})}">尾页</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    <div class="card-body">
        <!-- Table -->
        <div class="table-responsive">
            <table class="table table-striped table-hover table-bordered table-sm">
                <!--                    <caption>公告条目列表</caption>-->
                <thead class="thead-dark">
                <tr>
                    <th class="th1">
                        <input type="checkbox" class="checkbox-all">
                    </th>
                    <!--                    <th class="th2" scope="col">#</th>-->
                    <th class="th2" scope="col">ID</th>
                    <th class="th3" scope="col">标题</th>
                    <th class="th4" scope="col">内容</th>
                    <th class="th5" scope="col">
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发布日期&nbsp;&nbsp;
                        <button type="button" class="btn btn-sm btn-sort btn-sort-date">
                            <span class="glyphicon glyphicon-sort"></span>
                        </button>
                    </th>
                    <!--                    <th class="th6" scope="col">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;修改日期&nbsp;&nbsp;-->
                    <!--                        <button type="button" class="btn btn-sm btn-sort btn-sort-dateModified">-->
                    <!--                            <span class="glyphicon glyphicon-sort"></span>-->
                    <!--                        </button>-->
                    <!--                    </th>-->
                    <th class="th6" scope="col">修改日期</th>
                    <th class="th7" scope="col">置顶</th>
                    <th class="th8" scope="col">操作</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="item,start:${news}" th:data-newsid="${item.nId}">
                    <!--                <tr th:each="item,start:${news}" th:data-newsid="${item.nId}">-->
                    <th>
                        <input type="checkbox" class="checkbox-to-all" th:data-newsid="${item.nId}">
                    </th>
                    <!--                    <th scope="row" th:text="${start.index+1}">#</th>-->
                    <th scope="row" th:text="${item.nId}">ID</th>
                    <td class="td1" th:text="${item.nTitle}">标题</td>
                    <td class="td1" th:text="${item.nText}">内容</td>
                    <!--                    <td th:text="${#dates.format(item.nDate,'yyyy-MM-dd HH:mm:ss')}">发布日期</td>-->
                    <td th:text="${#dates.format(item.nDate,'yyyy-MM-dd HH:mm:ss')}">发布日期</td>
                    <td th:text="${#dates.format(item.nDateModified,'yyyy-MM-dd HH:mm:ss')}">修改日期</td>
                    <td th:text="${item.nStatus}">置顶</td>
                    <td>
                        <!-- 打开详情页面事件 -->
                        <button class="btn btn-info btn-detail btn-sm" data-toggle="modal" data-target="">
                            详情
                        </button>
                        <!-- 打开修改页面事件 -->
                        <button class="btn btn-warning btn-sm btn-openUpdate" data-toggle="modal" data-target="">修改
                        </button>
                        <!-- 删除事件 -->
                        <button class="btn btn-danger btn-delete btn-sm">删除</button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="card-footer">
        <ul class="logsUl">
            <li>共&nbsp;<a th:text="${pageInfo.total}"></a>&nbsp;条</li>
            <li>|</li>
            <li>每页&nbsp;<a th:text="${pageInfo.size}"></a>&nbsp;条</li>
            <li>|</li>
            <li>共&nbsp;<a th:text="${pageInfo.pages}"></a>&nbsp;页</li>
        </ul>
    </div>
</div>

<!-- Modal1 详情页面 -->
<div class="modal fade bd-example-modal-lg" id="exampleModalCenter" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle">公告详情</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">标题</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsTitle" placeholder="" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">&nbsp;&nbsp;ID&nbsp;&nbsp;</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsId" placeholder="" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">发布日期</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsDate" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">修改日期</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsDateModified" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">置顶</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsStatus" disabled>
                </div>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">内容</span>
                    </div>
                    <textarea class="form-control" aria-label="With textarea" rows="15" id="inputNewsText"
                              disabled></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal2 修改页面 -->
<div class="modal fade bd-example-modal-lg" id="exampleModalCenter2" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle2">修改公告</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">标题</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsTitle2" placeholder="">
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">&nbsp;&nbsp;ID&nbsp;&nbsp;</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsId2" placeholder="" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">发布日期</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsDate2" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">修改日期</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsDateModified2" disabled>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">置顶</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsStatus2">
                </div>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">内容</span>
                    </div>
                    <textarea class="form-control" aria-label="With textarea" rows="15" id="inputNewsText2"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                <!-- 修改事件 -->
                <button type="button" class="btn btn-success btn-update" data-dismiss="modal">保存修改</button>
                <!-- 测试 -->
                <!--                <button type="button" class="btn btn-danger btn-alert">测试</button>-->
            </div>
        </div>
    </div>
</div>

<!-- Modal3 添加公告页面 -->
<div class="modal fade bd-example-modal-lg" id="exampleModalCenter3" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle3">发布公告</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">标题</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsTitle3" placeholder="">
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">置顶</span>
                    </div>
                    <input type="text" class="form-control" id="inputNewsStatus3" disabled>
                </div>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">内容</span>
                    </div>
                    <textarea class="form-control" aria-label="With textarea" rows="15" id="inputNewsText3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                <!-- 修改事件 -->
                <button type="button" class="btn btn-success btn-insert" data-dismiss="modal">发布</button>
                <!-- 测试 -->
                <!--                <button type="button" class="btn btn-danger btn-alert">测试</button>-->
            </div>
        </div>
    </div>
    >>>>>>> Stashed changes
</div>

<script src="/js/logs.js"></script>
<script>
    function Toast(msg, duration) {
        duration = isNaN(duration) ? 3000 : duration;
        var m = document.createElement('div');
        m.innerHTML = msg;
        m.className = "warn15"

        document.body.appendChild(m);
        setTimeout(function () {
            var d = 0.5;
            m.style.webkitTransition = '-webkit-transform ' + d + 's ease-in, opacity ' + d + 's ease-in';
            m.style.opacity = '0';
            setTimeout(function () {
                document.body.removeChild(m)
            }, d * 1000);
        }, duration);
    }

    /*将数字时间戳转换为正确时间显示*/
    function getDate(nS) {
        var date = new Date(nS);
        var datetime = date.getFullYear()
            + "-"
            + ((date.getMonth() + 1) > 9 ? (date.getMonth() + 1) : "0" + (date.getMonth() + 1))
            + "-"
            + (date.getDate() < 10 ? "0" + date.getDate() : date.getDate())
            + " "
            + (date.getHours() < 10 ? "0" + date.getHours() : date
                .getHours())
            + ":"
            + (date.getMinutes() < 10 ? "0" + date.getMinutes() : date
                .getMinutes())
            + ":"
            + (date.getSeconds() < 10 ? "0" + date.getSeconds() : date
                .getSeconds())
        ;
        return datetime;
    }

    /*判断时间是否加0，用于给修改事件使用*/
    function getNow(s) {
        return s < 10 ? '0' + s : s;
    }

    $(function () {
        /*添加公告事件*/
        $(".btn-insert").click(function () {
            /*val()能获取input、textarea改动后的值，attr("value")则只能获取input、textarea初始化时的值*/
            var newstitle = $("#inputNewsTitle3").val()
            var myDate = new Date();
            var year = myDate.getFullYear();        //获取当前年
            var month = myDate.getMonth() + 1;   //获取当前月
            var date = myDate.getDate();            //获取当前日
            var h = myDate.getHours();              //获取当前小时数(0-23)
            var m = myDate.getMinutes();          //获取当前分钟数(0-59)
            var s = myDate.getSeconds();
            var newsdate = year + '-' + getNow(month) + "-" + getNow(date) + " " + getNow(h) + ':' + getNow(m) + ":" + getNow(s);
            var newstext = $("#inputNewsText3").val()
            // newstext = newstext.replace(/\s/g, " ");
            // newstext = newstext.replace(/\n|\r\n|\r/g, "<br>").replace(/\s/g, " ");
            $.ajax({
                url: "/bs/newsInsert",
                type: "GET",
                dataType: "text",
                contentType: "application/json",
                data: {
                    "n_title": newstitle,
                    "n_date": newsdate,
                    "n_text": newstext
                },
                success: function (m) {

                    if (m == 1) {
                        //加载刷新父类页面并关闭弹窗
                        window.parent.location.reload();
                        parent.layer.closeAll('iframe');
                        // $("#contents").load("/bs/news") /*都用这个*/
                    } else if (m == 0) {

                    } else {
                        Toast("你的级别还不够高,加油吧！少年。", "2000")
                    }
                }
            })
        })

        /*删除事件*/
        $(".btn-delete").click(function () {
            var newsid = $(this).parents("tr").attr("data-newsid")
            $.ajax({
                url: "/bs/newsDeleteByPrimaryKey",
                type: "GET",
                dataType: "text",
                contentType: "application/json",
                data: {"n_id": newsid},
                success: function (m) {

                    if (m == 1) {
                        $("#contents").load("/bs/news") /*都用这个*/
                    } else if (m == 0) {

                    } else {
                        Toast("你的级别还不够高,加油吧！少年。", "2000")
                    }
                }
            })
        })

        /*批量删除事件*/
        $(".btn-deleteByBatch").click(function () {
            // var newsid = $(this).parents("tr").attr("data-newsid")
            var newsids = '';
            $('.checkbox-to-all').each(function () {
                if (this.checked == true) {
                    var newsid = $(this).attr("data-newsid");
                    newsids += newsid + ' ';
                }
            })
            // alert(newsids)
            $.ajax({
                url: "/bs/newsDeleteByBatch",
                type: "GET",
                dataType: "text",
                contentType: "application/json",
                data: {"n_ids": newsids},
                //success function里的参数m是controller类的返回值
                success: function (m) {
                    $("#contents").load("/bs/news") /*都用这个*/
                    // if (m == 1) {
                    //     $("#contents").load("/bs/news") /*都用这个*/
                    // } else if (m == 0) {
                    //
                    // } else {
                    //     Toast("你的级别还不够高,加油吧！少年。", "2000")
                    // }
                }
            })
        })

        /*测试*/
        // $(".btn-alert").click(function () {
        //     // var newsid =  $("#inputNewsId2").attr("value")
        //     // var newstitle = $("input[id='inputNewsTitle2']").attr("value")
        //     // alert(newsid)
        //     // alert(newstitle)
        //     // alert(1)
        //     // var newstext = $("#inputNewsText2").attr("value")
        //     // var newstext = $("#inputNewsText2").val()
        //     // var newstext = $("#inputNewsText2").getText()
        //     // var newstitle = $("#inputNewsTitle3").val()
        //     // alert(newstitle)
        //
        // })

        /*修改事件*/
        $(".btn-update").click(function () {
            var newsid = $("#inputNewsId2").attr("value")
            /*val()能获取input、textarea改动后的值，attr("value")则只能获取input、textarea初始化时的值*/
            var newstitle = $("#inputNewsTitle2").val()
            var newsdate = $("#inputNewsDate2").val()
            var myDate = new Date();
            var year = myDate.getFullYear();        //获取当前年
            var month = myDate.getMonth() + 1;   //获取当前月
            var date = myDate.getDate();            //获取当前日
            var h = myDate.getHours();              //获取当前小时数(0-23)
            var m = myDate.getMinutes();          //获取当前分钟数(0-59)
            var s = myDate.getSeconds();
            var newsdatemodified = year + '-' + getNow(month) + "-" + getNow(date) + " " + getNow(h) + ':' + getNow(m) + ":" + getNow(s);
            var newstext = $("#inputNewsText2").val()
            // var newstext = $("#inputNewsText2").getText()
            // newstext = newstext.replace(/\n|\r\n|\r/g, "<br>").replace(/\s/g, " ");
            // newstext = newstext.replace(/\s/g, " ");
            var newsstatus = $("#inputNewsStatus2").val()
            $.ajax({
                url: "/bs/newsUpdate",
                type: "GET",
                dataType: "text",
                contentType: "application/json",
                data: {
                    "n_id": newsid,
                    "n_title": newstitle,
                    "n_date": newsdate,
                    "n_date_modified": newsdatemodified,
                    "n_text": newstext,
                    "n_status": newsstatus
                },
                success: function (m) {

                    if (m == 1) {
                        //加载刷新父类页面并关闭弹窗
                        window.parent.location.reload();
                        parent.layer.closeAll('iframe');

                        // $("#contents").load("/bs/news") /*都用这个*/
                    } else if (m == 0) {

                    } else {
                        Toast("你的级别还不够高,加油吧！少年。", "2000")
                    }
                }
            })
        })

        /*搜索事件*/
        $(".btn-search").click(function () {
            var newstitle = $("#n_title").val();
            if (newstitle != null) {
                $("#contents").load("/bs/news?n_title=" + newstitle)
            }
            // alert(newstitle)
        })

        /*按发布日期排序事件*/
        $(".btn-sort-date").click(function () {
            var sortFlag = 0;
            /*使用sessionStorage在页面刷新后保留数据（具体参见其生命周期）*/
            if (sessionStorage.getItem("key") == null) {
                sortFlag = 1;
                sessionStorage.setItem("key", "2");
                $("#contents").load("/bs/news?sortFlag=" + sortFlag)
            } else if (sessionStorage.getItem("key") == "2") {
                sortFlag = 2;
                sessionStorage.setItem("key", "1");
                $("#contents").load("/bs/news?sortFlag=" + sortFlag)
            } else if (sessionStorage.getItem("key") == "1") {
                sortFlag = 1;
                sessionStorage.setItem("key", "2");
                $("#contents").load("/bs/news?sortFlag=" + sortFlag)
            }
            // alert(newstitle)
        })
        /*按修改日期排序事件*/
        // $(".btn-sort-dateModified").click(function () {
        //     var sortFlag = 0;
        //     /*使用sessionStorage在页面刷新后保留数据（具体参见其生命周期）*/
        //     if (sessionStorage.getItem("key") == null) {
        //         sortFlag = 3;
        //         sessionStorage.setItem("key", "4");
        //         $("#contents").load("/bs/news?sortFlag=" + sortFlag)
        //     } else if (sessionStorage.getItem("key") == "2") {
        //         sortFlag = 4;
        //         sessionStorage.setItem("key", "3");
        //         $("#contents").load("/bs/news?sortFlag=" + sortFlag)
        //     } else if (sessionStorage.getItem("key") == "1") {
        //         sortFlag = 3;
        //         sessionStorage.setItem("key", "4");
        //         $("#contents").load("/bs/news?sortFlag=" + sortFlag)
        //     }
        //     // alert(newstitle)
        // })
        $(".btn-search").click(function () {
            var newstitle = $("#n_title").val();
            if (newstitle != null) {
                $("#contents").load("/bs/news?n_title=" + newstitle)
            }
            // alert(newstitle)
        })

        /*打开详情页面事件*/
        $(".btn-detail").click(function () {
            var newsid = $(this).parents("tr").attr("data-newsid")
            var flag = 0;
            $.ajax({
                url: "/bs/newsSelectByPrimaryKey",
                type: "GET",
                dataType: "json",
                async: false,
                contentType: "application/json",
                data: {"n_id": newsid},
                success: function (m) {
                    if (m != null) {
                        if (m.nId == newsid) {
                            // console.log(m.nId)
                            $("#inputNewsId").attr("value", m.nId)
                            $("#inputNewsTitle").attr("value", m.nTitle)
                            //使用getDate方法将时间戳（数字）转换为正确的时间显示
                            $("#inputNewsDate").attr("value", getDate(m.nDate))
                            if (m.nDateModified == null) {
                                $("#inputNewsDateModified").attr("value", "未修改")
                            } else {
                                $("#inputNewsDateModified").attr("value", getDate(m.nDateModified))
                            }
                            $("#inputNewsStatus").attr("value", m.nStatus)
                            var nText2 = m.nText;
                            // nText2=nText2.replace(/<br>/g, "\n");
                            $("#inputNewsText").html(nText2)
                            flag = 1;
                        } else {
                            Toast("你的级别还不够高,加油吧！少年。", "2000")
                        }
                    }
                    // console.log("执行")
                }
            })
            if (flag == 1) {
                // console.log("sfedfedf")
                $(this).attr("data-target", "#exampleModalCenter")
            }
        })

        /*打开修改页面事件*/
        $(".btn-openUpdate").click(function () {
            var newsid = $(this).parents("tr").attr("data-newsid")
            var flag = 0;
            $.ajax({
                url: "/bs/newsSelectByPrimaryKey",
                type: "GET",
                dataType: "json",
                async: false,
                contentType: "application/json",
                data: {"n_id": newsid},
                success: function (m) {
                    if (m != null) {
                        if (m.nId == newsid) {
                            // console.log(m.nId)
                            $("#inputNewsId2").attr("value", m.nId)
                            $("#inputNewsTitle2").attr("value", m.nTitle)
                            //使用getDate方法将时间戳（数字）转换为正确的时间显示
                            $("#inputNewsDate2").attr("value", getDate(m.nDate))
                            if (m.nDateModified == null) {
                                $("#inputNewsDateModified2").attr("value", "未修改")
                            } else {
                                $("#inputNewsDateModified2").attr("value", getDate(m.nDateModified))
                            }
                            $("#inputNewsStatus2").attr("value", m.nStatus)
                            var nText2 = m.nText;
                            // nText2=nText2.replace(/<br>/g, "\n");
                            $("#inputNewsText2").html(nText2)
                            flag = 1;
                        } else {
                            Toast("你的级别还不够高,加油吧！少年。", "2000")
                        }
                    }
                    // console.log("执行")
                }
            })
            if (flag == 1) {
                // console.log("sfedfedf")
                $(this).attr("data-target", "#exampleModalCenter2")
            }
        })

        /*打开添加页面事件*/
        $(".btn-openInsert").click(function () {
            $(this).attr("data-target", "#exampleModalCenter3")
        })

        /*checkbox全选与取消全选*/
        $(".checkbox-all").click(function () {
            if ($(this).is(':checked')) {
                $(".checkbox-to-all").prop("checked", true);
            } else {
                $(".checkbox-to-all").prop("checked", false);
            }
        })


    })
</script>
<script>

</script>
</body>
</html>